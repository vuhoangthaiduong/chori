<div class="m-3 pt-3">
  <div class="d-flex justify-content-between align-items-center">
    <div>
      <span class="fas fa-lemon function-icon"></span>
      <span class="h1 px-1">My fridge (<%= @ingredients.length %>)</span>
    </div>
    <%= link_to "All ingredients", ingredients_path, class: "btn btn-secondary" %>
  </div>

  <div class="row mt-5">
    <div class="col-6">
      <table class="table table-striped">
        <thead class="thead-dark">
        <tr>
          <th scope="col">#</th>
          <th scope="col">Name</th>
          <th scope="col">Amount</th>
          <th scope="col">Action</th>
        </tr>
        </thead>

        <tbody>
        <% i = 0 %>
        <% @ingredients.each do |ingredient| %>
          <% record = IngredientsUser.find_by(user_id: current_user.id,
                                              ingredient_id: ingredient.id) %>
          <tr>
            <td><%= i += 1 %></td>
            <td><%= ingredient.name %></td>
            <td class="d-flex flex-row">
            <span><%= form_for record, remote: true do |f| %>
                <%= f.hidden_field :amount, value: record.amount.to_i + 1 %>
                <%= button_tag type: 'submit', class: "btn btn-default" do %>
                  <i class="fa fa-plus"></i>
                <% end %>
            <% end %>
            </span>

              <%= record.amount %>
              <% if record.amount != 0 %>
            <span><%= form_for record, remote: true do |f| %>
                <%= f.hidden_field :amount, value: record.amount.to_i - 1 %>
                <%= button_tag type: 'submit', class: "btn btn-default" do %>
                  <i class="fa fa-minus"></i>
                <% end %>
            <% end %>
            </span>
              <% end %>
            </td>
            <td>
            <span><%= button_to record, method: :delete,
                                remote: true, class: "btn btn-default" do %>
              <span class="fas fa-trash"></span>
            <% end %>
            </span>

            </td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>

    <!--  All ingredients-->
    <div class="col-6">
      <form class="form-inline">
          <%= form_tag ingredients_path, method: 'get' do %>
            <div class="d-flex flex-row justify-content-between">
              <%= text_field_tag :search, params[:search], class: "form-control mr-3", placeholder: "Search ingredients" %>
              <%= submit_tag "Search", name: nil, class: "btn btn-primary" %>
            </div>
          <% end %>
      </form>
      <ul class="list-group h-25 overflow-auto mt-3">
        <% @all_ingredients.each do |ingredient| %>
          <li class="list-group-item d-flex justify-content-between">
            <%= link_to ingredient.name, ingredient %>
            <%= button_to current_user.ingredients_users.build, remote: true,
                          class: "btn btn-default" do %>
              <div><%= hidden_field_tag :ingredient_id, ingredient.id %></div>
              <span class="fas fa-plus"></span>
            <% end %>
          </li>
        <% end %>
      </ul>
    </div>


  </div>
</div>